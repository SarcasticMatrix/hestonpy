{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 1,
   "id": "baa49a5c-d599-439a-99eb-ef729adfab0d",
   "metadata": {},
   "outputs": [],
   "source": [
    "from hestonpy.models.heston import Heston\n",
    "from hestonpy.models.calibration.volatilitySmile import VolatilitySmile, fontdict\n",
    "from hestonpy.option.data import get_options_data, filter_data_for_maturity\n",
    "\n",
    "import matplotlib.pyplot as plt\n",
    "import matplotlib.font_manager as font_manager\n",
    "font_legend = font_manager.FontProperties(\n",
    "    style='normal', \n",
    "    size=10,\n",
    ")\n",
    "fontdict_title = {\n",
    "    'fontsize': 20,\n",
    "    'fontweight': 'bold'\n",
    "    }\n",
    "from datetime import datetime\n",
    "import numpy as np"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "c5ae987d-564a-42ac-abbd-38fde6f2101e",
   "metadata": {},
   "source": [
    "# Calibration of Heston models on market data"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "4f15bea4-bee4-4544-add4-4e348def75f7",
   "metadata": {},
   "source": [
    "We will calibrate our models on S&P smiles. You can also try with Apple, but there is less liquidity on the market, so less available maturities. Some parameters,"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "id": "328842ef-cc4d-49da-b292-0b8d09d387ac",
   "metadata": {},
   "outputs": [],
   "source": [
    "symbol = '^SPX'\n",
    "all_market_data, spot, maturities = get_options_data(symbol)\n",
    "if symbol == '^SPX':\n",
    "    considered_maturities = [maturities[7], maturities[14], maturities[28], maturities[38]]\n",
    "else:\n",
    "    considered_maturities = [maturities[1], maturities[3], maturities[8], maturities[14]]\n",
    "    \n",
    "r = 0.00\n",
    "params = {\n",
    "    \"vol_initial\": 0.06,\n",
    "    \"kappa\": 1.25,\n",
    "    \"theta\": 0.06,\n",
    "    \"drift_emm\": 0.00,\n",
    "    \"sigma\": 0.6,\n",
    "    \"rho\": -0.8,\n",
    "}"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "42768608-2463-4681-8e33-06d50fa342cb",
   "metadata": {},
   "source": [
    "For each maturity/smile we filter the data (based on bid-ask spread, the moneyness etc.), then we calibrate with a local optimiser to initialise our global optimiser."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "id": "05d0b385-0b4f-4de0-bd03-54a756bef07e",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "================================================================================\n",
      "2025-04-11\n",
      "================================================================================ \n",
      "\n"
     ]
    },
    {
     "ename": "KeyboardInterrupt",
     "evalue": "",
     "output_type": "error",
     "traceback": [
      "\u001b[0;31m---------------------------------------------------------------------------\u001b[0m",
      "\u001b[0;31mKeyboardInterrupt\u001b[0m                         Traceback (most recent call last)",
      "Cell \u001b[0;32mIn[3], line 38\u001b[0m\n\u001b[1;32m     34\u001b[0m \u001b[38;5;66;03m####################################\u001b[39;00m\n\u001b[1;32m     35\u001b[0m \u001b[38;5;66;03m### Calibration \u001b[39;00m\n\u001b[1;32m     36\u001b[0m \u001b[38;5;66;03m####################################\u001b[39;00m\n\u001b[1;32m     37\u001b[0m heston \u001b[38;5;241m=\u001b[39m Heston(spot\u001b[38;5;241m=\u001b[39mspot, r\u001b[38;5;241m=\u001b[39mr, \u001b[38;5;241m*\u001b[39m\u001b[38;5;241m*\u001b[39mparams)\n\u001b[0;32m---> 38\u001b[0m initial_params \u001b[38;5;241m=\u001b[39m \u001b[43mmarketVolatilitySmile\u001b[49m\u001b[38;5;241;43m.\u001b[39;49m\u001b[43mcalibration\u001b[49m\u001b[43m(\u001b[49m\n\u001b[1;32m     39\u001b[0m \u001b[43m    \u001b[49m\u001b[43mprice_function\u001b[49m\u001b[38;5;241;43m=\u001b[39;49m\u001b[43mheston\u001b[49m\u001b[38;5;241;43m.\u001b[39;49m\u001b[43mcall_price\u001b[49m\u001b[43m,\u001b[49m\n\u001b[1;32m     40\u001b[0m \u001b[43m    \u001b[49m\u001b[43mguess_correlation_sign\u001b[49m\u001b[38;5;241;43m=\u001b[39;49m\u001b[38;5;124;43m'\u001b[39;49m\u001b[38;5;124;43mnegative\u001b[39;49m\u001b[38;5;124;43m'\u001b[39;49m\u001b[43m,\u001b[49m\n\u001b[1;32m     41\u001b[0m \u001b[43m    \u001b[49m\u001b[43minitial_guess\u001b[49m\u001b[38;5;241;43m=\u001b[39;49m\u001b[43m[\u001b[49m\u001b[43mparams\u001b[49m\u001b[43m[\u001b[49m\u001b[38;5;124;43m'\u001b[39;49m\u001b[38;5;124;43mkappa\u001b[39;49m\u001b[38;5;124;43m'\u001b[39;49m\u001b[43m]\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mparams\u001b[49m\u001b[43m[\u001b[49m\u001b[38;5;124;43m'\u001b[39;49m\u001b[38;5;124;43mtheta\u001b[39;49m\u001b[38;5;124;43m'\u001b[39;49m\u001b[43m]\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mparams\u001b[49m\u001b[43m[\u001b[49m\u001b[38;5;124;43m'\u001b[39;49m\u001b[38;5;124;43msigma\u001b[39;49m\u001b[38;5;124;43m'\u001b[39;49m\u001b[43m]\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mparams\u001b[49m\u001b[43m[\u001b[49m\u001b[38;5;124;43m'\u001b[39;49m\u001b[38;5;124;43mrho\u001b[39;49m\u001b[38;5;124;43m'\u001b[39;49m\u001b[43m]\u001b[49m\u001b[43m]\u001b[49m\u001b[43m,\u001b[49m\n\u001b[1;32m     42\u001b[0m \u001b[43m    \u001b[49m\u001b[43mspeed\u001b[49m\u001b[38;5;241;43m=\u001b[39;49m\u001b[38;5;124;43m'\u001b[39;49m\u001b[38;5;124;43mlocal\u001b[39;49m\u001b[38;5;124;43m'\u001b[39;49m\u001b[43m,\u001b[49m\n\u001b[1;32m     43\u001b[0m \u001b[43m\u001b[49m\u001b[43m)\u001b[49m\n\u001b[1;32m     45\u001b[0m \u001b[38;5;66;03m# Absolute calibration\u001b[39;00m\n\u001b[1;32m     46\u001b[0m calibrated_params \u001b[38;5;241m=\u001b[39m marketVolatilitySmile\u001b[38;5;241m.\u001b[39mcalibration(\n\u001b[1;32m     47\u001b[0m     relative_errors\u001b[38;5;241m=\u001b[39m\u001b[38;5;28;01mFalse\u001b[39;00m,\n\u001b[1;32m     48\u001b[0m     price_function\u001b[38;5;241m=\u001b[39mheston\u001b[38;5;241m.\u001b[39mcall_price,\n\u001b[0;32m   (...)\u001b[0m\n\u001b[1;32m     52\u001b[0m     power\u001b[38;5;241m=\u001b[39m\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mmse\u001b[39m\u001b[38;5;124m'\u001b[39m\n\u001b[1;32m     53\u001b[0m )\n",
      "File \u001b[0;32m~/Documents/packages/hestonpy/src/hestonpy/models/calibration/volatilitySmile.py:293\u001b[0m, in \u001b[0;36mVolatilitySmile.calibration\u001b[0;34m(self, price_function, initial_guess, guess_correlation_sign, speed, power, method, weights, relative_errors)\u001b[0m\n\u001b[1;32m    291\u001b[0m     \u001b[38;5;28;01mwith\u001b[39;00m warnings\u001b[38;5;241m.\u001b[39mcatch_warnings():\n\u001b[1;32m    292\u001b[0m         warnings\u001b[38;5;241m.\u001b[39msimplefilter(\u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mignore\u001b[39m\u001b[38;5;124m\"\u001b[39m, category\u001b[38;5;241m=\u001b[39m\u001b[38;5;167;01mRuntimeWarning\u001b[39;00m)\n\u001b[0;32m--> 293\u001b[0m         result \u001b[38;5;241m=\u001b[39m \u001b[43mminimize\u001b[49m\u001b[43m(\u001b[49m\u001b[43mcost_function\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43minitial_guess\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[38;5;241;43m*\u001b[39;49m\u001b[38;5;241;43m*\u001b[39;49m\u001b[43mminimizer_kwargs\u001b[49m\u001b[43m)\u001b[49m\n\u001b[1;32m    295\u001b[0m \u001b[38;5;66;03m########################################\u001b[39;00m\n\u001b[1;32m    296\u001b[0m \u001b[38;5;66;03m#### Global calibration scheme\u001b[39;00m\n\u001b[1;32m    297\u001b[0m \u001b[38;5;66;03m########################################\u001b[39;00m\n\u001b[1;32m    298\u001b[0m \u001b[38;5;28;01melif\u001b[39;00m speed \u001b[38;5;241m==\u001b[39m \u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mglobal\u001b[39m\u001b[38;5;124m\"\u001b[39m:\n",
      "File \u001b[0;32m~/Documents/packages/hestonpy/.venv/lib/python3.10/site-packages/scipy/optimize/_minimize.py:738\u001b[0m, in \u001b[0;36mminimize\u001b[0;34m(fun, x0, args, method, jac, hess, hessp, bounds, constraints, tol, callback, options)\u001b[0m\n\u001b[1;32m    735\u001b[0m     res \u001b[38;5;241m=\u001b[39m _minimize_newtoncg(fun, x0, args, jac, hess, hessp, callback,\n\u001b[1;32m    736\u001b[0m                              \u001b[38;5;241m*\u001b[39m\u001b[38;5;241m*\u001b[39moptions)\n\u001b[1;32m    737\u001b[0m \u001b[38;5;28;01melif\u001b[39;00m meth \u001b[38;5;241m==\u001b[39m \u001b[38;5;124m'\u001b[39m\u001b[38;5;124ml-bfgs-b\u001b[39m\u001b[38;5;124m'\u001b[39m:\n\u001b[0;32m--> 738\u001b[0m     res \u001b[38;5;241m=\u001b[39m \u001b[43m_minimize_lbfgsb\u001b[49m\u001b[43m(\u001b[49m\u001b[43mfun\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mx0\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43margs\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mjac\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mbounds\u001b[49m\u001b[43m,\u001b[49m\n\u001b[1;32m    739\u001b[0m \u001b[43m                           \u001b[49m\u001b[43mcallback\u001b[49m\u001b[38;5;241;43m=\u001b[39;49m\u001b[43mcallback\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[38;5;241;43m*\u001b[39;49m\u001b[38;5;241;43m*\u001b[39;49m\u001b[43moptions\u001b[49m\u001b[43m)\u001b[49m\n\u001b[1;32m    740\u001b[0m \u001b[38;5;28;01melif\u001b[39;00m meth \u001b[38;5;241m==\u001b[39m \u001b[38;5;124m'\u001b[39m\u001b[38;5;124mtnc\u001b[39m\u001b[38;5;124m'\u001b[39m:\n\u001b[1;32m    741\u001b[0m     res \u001b[38;5;241m=\u001b[39m _minimize_tnc(fun, x0, args, jac, bounds, callback\u001b[38;5;241m=\u001b[39mcallback,\n\u001b[1;32m    742\u001b[0m                         \u001b[38;5;241m*\u001b[39m\u001b[38;5;241m*\u001b[39moptions)\n",
      "File \u001b[0;32m~/Documents/packages/hestonpy/.venv/lib/python3.10/site-packages/scipy/optimize/_lbfgsb_py.py:441\u001b[0m, in \u001b[0;36m_minimize_lbfgsb\u001b[0;34m(fun, x0, args, jac, bounds, disp, maxcor, ftol, gtol, eps, maxfun, maxiter, iprint, callback, maxls, finite_diff_rel_step, **unknown_options)\u001b[0m\n\u001b[1;32m    433\u001b[0m _lbfgsb\u001b[38;5;241m.\u001b[39msetulb(m, x, low_bnd, upper_bnd, nbd, f, g, factr, pgtol, wa,\n\u001b[1;32m    434\u001b[0m                iwa, task, lsave, isave, dsave, maxls, ln_task)\n\u001b[1;32m    436\u001b[0m \u001b[38;5;28;01mif\u001b[39;00m task[\u001b[38;5;241m0\u001b[39m] \u001b[38;5;241m==\u001b[39m \u001b[38;5;241m3\u001b[39m:\n\u001b[1;32m    437\u001b[0m     \u001b[38;5;66;03m# The minimization routine wants f and g at the current x.\u001b[39;00m\n\u001b[1;32m    438\u001b[0m     \u001b[38;5;66;03m# Note that interruptions due to maxfun are postponed\u001b[39;00m\n\u001b[1;32m    439\u001b[0m     \u001b[38;5;66;03m# until the completion of the current minimization iteration.\u001b[39;00m\n\u001b[1;32m    440\u001b[0m     \u001b[38;5;66;03m# Overwrite f and g:\u001b[39;00m\n\u001b[0;32m--> 441\u001b[0m     f, g \u001b[38;5;241m=\u001b[39m \u001b[43mfunc_and_grad\u001b[49m\u001b[43m(\u001b[49m\u001b[43mx\u001b[49m\u001b[43m)\u001b[49m\n\u001b[1;32m    442\u001b[0m \u001b[38;5;28;01melif\u001b[39;00m task[\u001b[38;5;241m0\u001b[39m] \u001b[38;5;241m==\u001b[39m \u001b[38;5;241m1\u001b[39m:\n\u001b[1;32m    443\u001b[0m     \u001b[38;5;66;03m# new iteration\u001b[39;00m\n\u001b[1;32m    444\u001b[0m     n_iterations \u001b[38;5;241m+\u001b[39m\u001b[38;5;241m=\u001b[39m \u001b[38;5;241m1\u001b[39m\n",
      "File \u001b[0;32m~/Documents/packages/hestonpy/.venv/lib/python3.10/site-packages/scipy/optimize/_differentiable_functions.py:345\u001b[0m, in \u001b[0;36mScalarFunction.fun_and_grad\u001b[0;34m(self, x)\u001b[0m\n\u001b[1;32m    343\u001b[0m     \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_update_x(x)\n\u001b[1;32m    344\u001b[0m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_update_fun()\n\u001b[0;32m--> 345\u001b[0m \u001b[38;5;28;43mself\u001b[39;49m\u001b[38;5;241;43m.\u001b[39;49m\u001b[43m_update_grad\u001b[49m\u001b[43m(\u001b[49m\u001b[43m)\u001b[49m\n\u001b[1;32m    346\u001b[0m \u001b[38;5;28;01mreturn\u001b[39;00m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mf, \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mg\n",
      "File \u001b[0;32m~/Documents/packages/hestonpy/.venv/lib/python3.10/site-packages/scipy/optimize/_differentiable_functions.py:307\u001b[0m, in \u001b[0;36mScalarFunction._update_grad\u001b[0;34m(self)\u001b[0m\n\u001b[1;32m    305\u001b[0m \u001b[38;5;28;01mif\u001b[39;00m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_orig_grad \u001b[38;5;129;01min\u001b[39;00m FD_METHODS:\n\u001b[1;32m    306\u001b[0m     \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_update_fun()\n\u001b[0;32m--> 307\u001b[0m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mg \u001b[38;5;241m=\u001b[39m \u001b[38;5;28;43mself\u001b[39;49m\u001b[38;5;241;43m.\u001b[39;49m\u001b[43m_wrapped_grad\u001b[49m\u001b[43m(\u001b[49m\u001b[38;5;28;43mself\u001b[39;49m\u001b[38;5;241;43m.\u001b[39;49m\u001b[43mx\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mf0\u001b[49m\u001b[38;5;241;43m=\u001b[39;49m\u001b[38;5;28;43mself\u001b[39;49m\u001b[38;5;241;43m.\u001b[39;49m\u001b[43mf\u001b[49m\u001b[43m)\u001b[49m\n\u001b[1;32m    308\u001b[0m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mg_updated \u001b[38;5;241m=\u001b[39m \u001b[38;5;28;01mTrue\u001b[39;00m\n",
      "File \u001b[0;32m~/Documents/packages/hestonpy/.venv/lib/python3.10/site-packages/scipy/optimize/_differentiable_functions.py:48\u001b[0m, in \u001b[0;36m_wrapper_grad.<locals>.wrapped1\u001b[0;34m(x, f0)\u001b[0m\n\u001b[1;32m     46\u001b[0m \u001b[38;5;28;01mdef\u001b[39;00m\u001b[38;5;250m \u001b[39m\u001b[38;5;21mwrapped1\u001b[39m(x, f0\u001b[38;5;241m=\u001b[39m\u001b[38;5;28;01mNone\u001b[39;00m):\n\u001b[1;32m     47\u001b[0m     ncalls[\u001b[38;5;241m0\u001b[39m] \u001b[38;5;241m+\u001b[39m\u001b[38;5;241m=\u001b[39m \u001b[38;5;241m1\u001b[39m\n\u001b[0;32m---> 48\u001b[0m     \u001b[38;5;28;01mreturn\u001b[39;00m \u001b[43mapprox_derivative\u001b[49m\u001b[43m(\u001b[49m\n\u001b[1;32m     49\u001b[0m \u001b[43m        \u001b[49m\u001b[43mfun\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mx\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mf0\u001b[49m\u001b[38;5;241;43m=\u001b[39;49m\u001b[43mf0\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[38;5;241;43m*\u001b[39;49m\u001b[38;5;241;43m*\u001b[39;49m\u001b[43mfinite_diff_options\u001b[49m\n\u001b[1;32m     50\u001b[0m \u001b[43m    \u001b[49m\u001b[43m)\u001b[49m\n",
      "File \u001b[0;32m~/Documents/packages/hestonpy/.venv/lib/python3.10/site-packages/scipy/optimize/_numdiff.py:523\u001b[0m, in \u001b[0;36mapprox_derivative\u001b[0;34m(fun, x0, method, rel_step, abs_step, f0, bounds, sparsity, as_linear_operator, args, kwargs)\u001b[0m\n\u001b[1;32m    520\u001b[0m     use_one_sided \u001b[38;5;241m=\u001b[39m \u001b[38;5;28;01mFalse\u001b[39;00m\n\u001b[1;32m    522\u001b[0m \u001b[38;5;28;01mif\u001b[39;00m sparsity \u001b[38;5;129;01mis\u001b[39;00m \u001b[38;5;28;01mNone\u001b[39;00m:\n\u001b[0;32m--> 523\u001b[0m     \u001b[38;5;28;01mreturn\u001b[39;00m \u001b[43m_dense_difference\u001b[49m\u001b[43m(\u001b[49m\u001b[43mfun_wrapped\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mx0\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mf0\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mh\u001b[49m\u001b[43m,\u001b[49m\n\u001b[1;32m    524\u001b[0m \u001b[43m                             \u001b[49m\u001b[43muse_one_sided\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mmethod\u001b[49m\u001b[43m)\u001b[49m\n\u001b[1;32m    525\u001b[0m \u001b[38;5;28;01melse\u001b[39;00m:\n\u001b[1;32m    526\u001b[0m     \u001b[38;5;28;01mif\u001b[39;00m \u001b[38;5;129;01mnot\u001b[39;00m issparse(sparsity) \u001b[38;5;129;01mand\u001b[39;00m \u001b[38;5;28mlen\u001b[39m(sparsity) \u001b[38;5;241m==\u001b[39m \u001b[38;5;241m2\u001b[39m:\n",
      "File \u001b[0;32m~/Documents/packages/hestonpy/.venv/lib/python3.10/site-packages/scipy/optimize/_numdiff.py:596\u001b[0m, in \u001b[0;36m_dense_difference\u001b[0;34m(fun, x0, f0, h, use_one_sided, method)\u001b[0m\n\u001b[1;32m    594\u001b[0m     x1[i] \u001b[38;5;241m+\u001b[39m\u001b[38;5;241m=\u001b[39m h[i]\n\u001b[1;32m    595\u001b[0m     dx \u001b[38;5;241m=\u001b[39m x1[i] \u001b[38;5;241m-\u001b[39m x0[i]  \u001b[38;5;66;03m# Recompute dx as exactly representable number.\u001b[39;00m\n\u001b[0;32m--> 596\u001b[0m     df \u001b[38;5;241m=\u001b[39m \u001b[43mfun\u001b[49m\u001b[43m(\u001b[49m\u001b[43mx1\u001b[49m\u001b[43m)\u001b[49m \u001b[38;5;241m-\u001b[39m f0\n\u001b[1;32m    597\u001b[0m \u001b[38;5;28;01melif\u001b[39;00m method \u001b[38;5;241m==\u001b[39m \u001b[38;5;124m'\u001b[39m\u001b[38;5;124m3-point\u001b[39m\u001b[38;5;124m'\u001b[39m \u001b[38;5;129;01mand\u001b[39;00m use_one_sided[i]:\n\u001b[1;32m    598\u001b[0m     x1[i] \u001b[38;5;241m+\u001b[39m\u001b[38;5;241m=\u001b[39m h[i]\n",
      "File \u001b[0;32m~/Documents/packages/hestonpy/.venv/lib/python3.10/site-packages/scipy/optimize/_numdiff.py:474\u001b[0m, in \u001b[0;36mapprox_derivative.<locals>.fun_wrapped\u001b[0;34m(x)\u001b[0m\n\u001b[1;32m    471\u001b[0m \u001b[38;5;28;01mif\u001b[39;00m xp\u001b[38;5;241m.\u001b[39misdtype(x\u001b[38;5;241m.\u001b[39mdtype, \u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mreal floating\u001b[39m\u001b[38;5;124m\"\u001b[39m):\n\u001b[1;32m    472\u001b[0m     x \u001b[38;5;241m=\u001b[39m xp\u001b[38;5;241m.\u001b[39mastype(x, x0\u001b[38;5;241m.\u001b[39mdtype)\n\u001b[0;32m--> 474\u001b[0m f \u001b[38;5;241m=\u001b[39m np\u001b[38;5;241m.\u001b[39matleast_1d(\u001b[43mfun\u001b[49m\u001b[43m(\u001b[49m\u001b[43mx\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[38;5;241;43m*\u001b[39;49m\u001b[43margs\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[38;5;241;43m*\u001b[39;49m\u001b[38;5;241;43m*\u001b[39;49m\u001b[43mkwargs\u001b[49m\u001b[43m)\u001b[49m)\n\u001b[1;32m    475\u001b[0m \u001b[38;5;28;01mif\u001b[39;00m f\u001b[38;5;241m.\u001b[39mndim \u001b[38;5;241m>\u001b[39m \u001b[38;5;241m1\u001b[39m:\n\u001b[1;32m    476\u001b[0m     \u001b[38;5;28;01mraise\u001b[39;00m \u001b[38;5;167;01mRuntimeError\u001b[39;00m(\u001b[38;5;124m\"\u001b[39m\u001b[38;5;124m`fun` return value has \u001b[39m\u001b[38;5;124m\"\u001b[39m\n\u001b[1;32m    477\u001b[0m                        \u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mmore than 1 dimension.\u001b[39m\u001b[38;5;124m\"\u001b[39m)\n",
      "File \u001b[0;32m~/Documents/packages/hestonpy/.venv/lib/python3.10/site-packages/scipy/optimize/_differentiable_functions.py:21\u001b[0m, in \u001b[0;36m_wrapper_fun.<locals>.wrapped\u001b[0;34m(x)\u001b[0m\n\u001b[1;32m     17\u001b[0m ncalls[\u001b[38;5;241m0\u001b[39m] \u001b[38;5;241m+\u001b[39m\u001b[38;5;241m=\u001b[39m \u001b[38;5;241m1\u001b[39m\n\u001b[1;32m     18\u001b[0m \u001b[38;5;66;03m# Send a copy because the user may overwrite it.\u001b[39;00m\n\u001b[1;32m     19\u001b[0m \u001b[38;5;66;03m# Overwriting results in undefined behaviour because\u001b[39;00m\n\u001b[1;32m     20\u001b[0m \u001b[38;5;66;03m# fun(self.x) will change self.x, with the two no longer linked.\u001b[39;00m\n\u001b[0;32m---> 21\u001b[0m fx \u001b[38;5;241m=\u001b[39m \u001b[43mfun\u001b[49m\u001b[43m(\u001b[49m\u001b[43mnp\u001b[49m\u001b[38;5;241;43m.\u001b[39;49m\u001b[43mcopy\u001b[49m\u001b[43m(\u001b[49m\u001b[43mx\u001b[49m\u001b[43m)\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[38;5;241;43m*\u001b[39;49m\u001b[43margs\u001b[49m\u001b[43m)\u001b[49m\n\u001b[1;32m     22\u001b[0m \u001b[38;5;66;03m# Make sure the function returns a true scalar\u001b[39;00m\n\u001b[1;32m     23\u001b[0m \u001b[38;5;28;01mif\u001b[39;00m \u001b[38;5;129;01mnot\u001b[39;00m np\u001b[38;5;241m.\u001b[39misscalar(fx):\n",
      "File \u001b[0;32m~/Documents/packages/hestonpy/src/hestonpy/models/calibration/volatilitySmile.py:270\u001b[0m, in \u001b[0;36mVolatilitySmile.calibration.<locals>.cost_function\u001b[0;34m(params)\u001b[0m\n\u001b[1;32m    268\u001b[0m \u001b[38;5;28;01mdef\u001b[39;00m\u001b[38;5;250m \u001b[39m\u001b[38;5;21mcost_function\u001b[39m(params):\n\u001b[1;32m    269\u001b[0m     function_params \u001b[38;5;241m=\u001b[39m _get_parameters(model_type, params)\n\u001b[0;32m--> 270\u001b[0m     model_prices \u001b[38;5;241m=\u001b[39m \u001b[43mprice_function\u001b[49m\u001b[43m(\u001b[49m\n\u001b[1;32m    271\u001b[0m \u001b[43m        \u001b[49m\u001b[38;5;241;43m*\u001b[39;49m\u001b[38;5;241;43m*\u001b[39;49m\u001b[43mfunction_params\u001b[49m\u001b[43m,\u001b[49m\n\u001b[1;32m    272\u001b[0m \u001b[43m        \u001b[49m\u001b[43mv\u001b[49m\u001b[38;5;241;43m=\u001b[39;49m\u001b[43mvol_initial\u001b[49m\u001b[43m,\u001b[49m\n\u001b[1;32m    273\u001b[0m \u001b[43m        \u001b[49m\u001b[43mstrike\u001b[49m\u001b[38;5;241;43m=\u001b[39;49m\u001b[38;5;28;43mself\u001b[39;49m\u001b[38;5;241;43m.\u001b[39;49m\u001b[43mstrikes\u001b[49m\u001b[43m,\u001b[49m\n\u001b[1;32m    274\u001b[0m \u001b[43m        \u001b[49m\u001b[43mtime_to_maturity\u001b[49m\u001b[38;5;241;43m=\u001b[39;49m\u001b[38;5;28;43mself\u001b[39;49m\u001b[38;5;241;43m.\u001b[39;49m\u001b[43mtime_to_maturity\u001b[49m\u001b[43m,\u001b[49m\n\u001b[1;32m    275\u001b[0m \u001b[43m        \u001b[49m\u001b[43ms\u001b[49m\u001b[38;5;241;43m=\u001b[39;49m\u001b[38;5;28;43mself\u001b[39;49m\u001b[38;5;241;43m.\u001b[39;49m\u001b[43matm\u001b[49m\u001b[43m,\u001b[49m\n\u001b[1;32m    276\u001b[0m \u001b[43m    \u001b[49m\u001b[43m)\u001b[49m\n\u001b[1;32m    278\u001b[0m     \u001b[38;5;28;01mreturn\u001b[39;00m difference_function(\u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mmarket_prices, model_prices)\n",
      "File \u001b[0;32m~/Documents/packages/hestonpy/src/hestonpy/models/heston.py:353\u001b[0m, in \u001b[0;36mHeston.call_price\u001b[0;34m(self, strike, time_to_maturity, s, v, **kwargs)\u001b[0m\n\u001b[1;32m    331\u001b[0m \u001b[38;5;28;01mdef\u001b[39;00m\u001b[38;5;250m \u001b[39m\u001b[38;5;21mcall_price\u001b[39m(\n\u001b[1;32m    332\u001b[0m         \u001b[38;5;28mself\u001b[39m, \n\u001b[1;32m    333\u001b[0m         strike: np\u001b[38;5;241m.\u001b[39marray, \n\u001b[0;32m   (...)\u001b[0m\n\u001b[1;32m    337\u001b[0m         \u001b[38;5;241m*\u001b[39m\u001b[38;5;241m*\u001b[39mkwargs\n\u001b[1;32m    338\u001b[0m     ):\n\u001b[1;32m    339\u001b[0m \u001b[38;5;250m    \u001b[39m\u001b[38;5;124;03m\"\"\"\u001b[39;00m\n\u001b[1;32m    340\u001b[0m \u001b[38;5;124;03m    Price a European call option using the Carr-Madan method.\u001b[39;00m\n\u001b[1;32m    341\u001b[0m \n\u001b[0;32m   (...)\u001b[0m\n\u001b[1;32m    350\u001b[0m \u001b[38;5;124;03m    :rtype: float\u001b[39;00m\n\u001b[1;32m    351\u001b[0m \u001b[38;5;124;03m    \"\"\"\u001b[39;00m\n\u001b[0;32m--> 353\u001b[0m     price \u001b[38;5;241m=\u001b[39m \u001b[38;5;28;43mself\u001b[39;49m\u001b[38;5;241;43m.\u001b[39;49m\u001b[43mcarr_madan_price\u001b[49m\u001b[43m(\u001b[49m\n\u001b[1;32m    354\u001b[0m \u001b[43m        \u001b[49m\u001b[43ms\u001b[49m\u001b[38;5;241;43m=\u001b[39;49m\u001b[43ms\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\n\u001b[1;32m    355\u001b[0m \u001b[43m        \u001b[49m\u001b[43mv\u001b[49m\u001b[38;5;241;43m=\u001b[39;49m\u001b[43mv\u001b[49m\u001b[43m,\u001b[49m\n\u001b[1;32m    356\u001b[0m \u001b[43m        \u001b[49m\u001b[43mstrike\u001b[49m\u001b[38;5;241;43m=\u001b[39;49m\u001b[43mstrike\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\n\u001b[1;32m    357\u001b[0m \u001b[43m        \u001b[49m\u001b[43mtime_to_maturity\u001b[49m\u001b[38;5;241;43m=\u001b[39;49m\u001b[43mtime_to_maturity\u001b[49m\u001b[43m,\u001b[49m\n\u001b[1;32m    358\u001b[0m \u001b[43m        \u001b[49m\u001b[38;5;241;43m*\u001b[39;49m\u001b[38;5;241;43m*\u001b[39;49m\u001b[43mkwargs\u001b[49m\n\u001b[1;32m    359\u001b[0m \u001b[43m    \u001b[49m\u001b[43m)\u001b[49m\n\u001b[1;32m    360\u001b[0m     \u001b[38;5;28;01mreturn\u001b[39;00m price\n",
      "File \u001b[0;32m~/Documents/packages/hestonpy/src/hestonpy/models/heston.py:514\u001b[0m, in \u001b[0;36mHeston.carr_madan_price\u001b[0;34m(self, strike, time_to_maturity, s, v, error_boolean, **kwargs)\u001b[0m\n\u001b[1;32m    505\u001b[0m price_hat \u001b[38;5;241m=\u001b[39m (\n\u001b[1;32m    506\u001b[0m     \u001b[38;5;28;01mlambda\u001b[39;00m u: np\u001b[38;5;241m.\u001b[39mexp(\u001b[38;5;241m-\u001b[39m\u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mr \u001b[38;5;241m*\u001b[39m time_to_maturity)\n\u001b[1;32m    507\u001b[0m     \u001b[38;5;241m/\u001b[39m (alpha\u001b[38;5;241m*\u001b[39m\u001b[38;5;241m*\u001b[39m\u001b[38;5;241m2\u001b[39m \u001b[38;5;241m+\u001b[39m alpha \u001b[38;5;241m-\u001b[39m u\u001b[38;5;241m*\u001b[39m\u001b[38;5;241m*\u001b[39m\u001b[38;5;241m2\u001b[39m \u001b[38;5;241m+\u001b[39m u \u001b[38;5;241m*\u001b[39m (\u001b[38;5;241m2\u001b[39m \u001b[38;5;241m*\u001b[39m alpha \u001b[38;5;241m+\u001b[39m \u001b[38;5;241m1\u001b[39m) \u001b[38;5;241m*\u001b[39m \u001b[38;5;241m1\u001b[39mj)\n\u001b[1;32m    508\u001b[0m     \u001b[38;5;241m*\u001b[39m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mcharacteristic(j\u001b[38;5;241m=\u001b[39m\u001b[38;5;241m2\u001b[39m, \u001b[38;5;241m*\u001b[39m\u001b[38;5;241m*\u001b[39mkwargs)(x, v, time_to_maturity, u \u001b[38;5;241m-\u001b[39m (alpha \u001b[38;5;241m+\u001b[39m \u001b[38;5;241m1\u001b[39m) \u001b[38;5;241m*\u001b[39m \u001b[38;5;241m1\u001b[39mj)\n\u001b[1;32m    509\u001b[0m )\n\u001b[1;32m    511\u001b[0m integrand \u001b[38;5;241m=\u001b[39m \u001b[38;5;28;01mlambda\u001b[39;00m u: np\u001b[38;5;241m.\u001b[39mexp(\u001b[38;5;241m-\u001b[39mu \u001b[38;5;241m*\u001b[39m np\u001b[38;5;241m.\u001b[39mlog(strike) \u001b[38;5;241m*\u001b[39m \u001b[38;5;241m1\u001b[39mj) \u001b[38;5;241m*\u001b[39m price_hat(u)\n\u001b[1;32m    513\u001b[0m price \u001b[38;5;241m=\u001b[39m np\u001b[38;5;241m.\u001b[39mreal(\n\u001b[0;32m--> 514\u001b[0m     np\u001b[38;5;241m.\u001b[39mexp(\u001b[38;5;241m-\u001b[39malpha \u001b[38;5;241m*\u001b[39m np\u001b[38;5;241m.\u001b[39mlog(strike)) \u001b[38;5;241m/\u001b[39m np\u001b[38;5;241m.\u001b[39mpi \u001b[38;5;241m*\u001b[39m \u001b[43mquad_vec\u001b[49m\u001b[43m(\u001b[49m\u001b[43mf\u001b[49m\u001b[38;5;241;43m=\u001b[39;49m\u001b[43mintegrand\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43ma\u001b[49m\u001b[38;5;241;43m=\u001b[39;49m\u001b[38;5;241;43m0\u001b[39;49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mb\u001b[49m\u001b[38;5;241;43m=\u001b[39;49m\u001b[38;5;241;43m1000\u001b[39;49m\u001b[43m)\u001b[49m[\u001b[38;5;241m0\u001b[39m]\n\u001b[1;32m    515\u001b[0m )\n\u001b[1;32m    517\u001b[0m \u001b[38;5;28;01mif\u001b[39;00m error_boolean:\n\u001b[1;32m    518\u001b[0m     error \u001b[38;5;241m=\u001b[39m (\n\u001b[1;32m    519\u001b[0m         np\u001b[38;5;241m.\u001b[39mexp(\u001b[38;5;241m-\u001b[39malpha \u001b[38;5;241m*\u001b[39m np\u001b[38;5;241m.\u001b[39mlog(strike)) \u001b[38;5;241m/\u001b[39m np\u001b[38;5;241m.\u001b[39mpi \u001b[38;5;241m*\u001b[39m quad_vec(f\u001b[38;5;241m=\u001b[39mintegrand, a\u001b[38;5;241m=\u001b[39m\u001b[38;5;241m0\u001b[39m, b\u001b[38;5;241m=\u001b[39m\u001b[38;5;241m1000\u001b[39m)[\u001b[38;5;241m1\u001b[39m]\n\u001b[1;32m    520\u001b[0m     )\n",
      "File \u001b[0;32m~/Documents/packages/hestonpy/.venv/lib/python3.10/site-packages/scipy/integrate/_quad_vec.py:412\u001b[0m, in \u001b[0;36mquad_vec\u001b[0;34m(f, a, b, epsabs, epsrel, norm, cache_size, limit, workers, points, quadrature, full_output, args)\u001b[0m\n\u001b[1;32m    409\u001b[0m     err_sum \u001b[38;5;241m+\u001b[39m\u001b[38;5;241m=\u001b[39m \u001b[38;5;241m-\u001b[39mneg_old_err\n\u001b[1;32m    411\u001b[0m \u001b[38;5;66;03m# Subdivide intervals\u001b[39;00m\n\u001b[0;32m--> 412\u001b[0m \u001b[38;5;28;01mfor\u001b[39;00m parts \u001b[38;5;129;01min\u001b[39;00m mapwrapper(_subdivide_interval, to_process):\n\u001b[1;32m    413\u001b[0m     dint, derr, dround_err, subint, dneval \u001b[38;5;241m=\u001b[39m parts\n\u001b[1;32m    414\u001b[0m     neval \u001b[38;5;241m+\u001b[39m\u001b[38;5;241m=\u001b[39m dneval\n",
      "File \u001b[0;32m~/Documents/packages/hestonpy/.venv/lib/python3.10/site-packages/scipy/integrate/_quad_vec.py:472\u001b[0m, in \u001b[0;36m_subdivide_interval\u001b[0;34m(args)\u001b[0m\n\u001b[1;32m    470\u001b[0m s1, err1, round1 \u001b[38;5;241m=\u001b[39m _quadrature(a, c, f, norm_func)\n\u001b[1;32m    471\u001b[0m dneval \u001b[38;5;241m=\u001b[39m _quadrature\u001b[38;5;241m.\u001b[39mnum_eval\n\u001b[0;32m--> 472\u001b[0m s2, err2, round2 \u001b[38;5;241m=\u001b[39m \u001b[43m_quadrature\u001b[49m\u001b[43m(\u001b[49m\u001b[43mc\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mb\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mf\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mnorm_func\u001b[49m\u001b[43m)\u001b[49m\n\u001b[1;32m    473\u001b[0m dneval \u001b[38;5;241m+\u001b[39m\u001b[38;5;241m=\u001b[39m _quadrature\u001b[38;5;241m.\u001b[39mnum_eval\n\u001b[1;32m    474\u001b[0m \u001b[38;5;28;01mif\u001b[39;00m old_int \u001b[38;5;129;01mis\u001b[39;00m \u001b[38;5;28;01mNone\u001b[39;00m:\n",
      "File \u001b[0;32m~/Documents/packages/hestonpy/.venv/lib/python3.10/site-packages/scipy/integrate/_quad_vec.py:626\u001b[0m, in \u001b[0;36m_quadrature_gk21\u001b[0;34m(a, b, f, norm_func)\u001b[0m\n\u001b[1;32m    603\u001b[0m \u001b[38;5;66;03m# 21-point weights\u001b[39;00m\n\u001b[1;32m    604\u001b[0m v \u001b[38;5;241m=\u001b[39m (\u001b[38;5;241m0.011694638867371874278064396062192\u001b[39m,\n\u001b[1;32m    605\u001b[0m      \u001b[38;5;241m0.032558162307964727478818972459390\u001b[39m,\n\u001b[1;32m    606\u001b[0m      \u001b[38;5;241m0.054755896574351996031381300244580\u001b[39m,\n\u001b[0;32m   (...)\u001b[0m\n\u001b[1;32m    623\u001b[0m      \u001b[38;5;241m0.032558162307964727478818972459390\u001b[39m,\n\u001b[1;32m    624\u001b[0m      \u001b[38;5;241m0.011694638867371874278064396062192\u001b[39m)\n\u001b[0;32m--> 626\u001b[0m \u001b[38;5;28;01mreturn\u001b[39;00m \u001b[43m_quadrature_gk\u001b[49m\u001b[43m(\u001b[49m\u001b[43ma\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mb\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mf\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mnorm_func\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mx\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mw\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mv\u001b[49m\u001b[43m)\u001b[49m\n",
      "File \u001b[0;32m~/Documents/packages/hestonpy/.venv/lib/python3.10/site-packages/scipy/integrate/_quad_vec.py:535\u001b[0m, in \u001b[0;36m_quadrature_gk\u001b[0;34m(a, b, f, norm_func, x, w, v)\u001b[0m\n\u001b[1;32m    533\u001b[0m     s_k \u001b[38;5;241m+\u001b[39m\u001b[38;5;241m=\u001b[39m vv \u001b[38;5;241m*\u001b[39m ff\n\u001b[1;32m    534\u001b[0m     \u001b[38;5;66;03m# \\int |f(x)|\u001b[39;00m\n\u001b[0;32m--> 535\u001b[0m     s_k_abs \u001b[38;5;241m+\u001b[39m\u001b[38;5;241m=\u001b[39m vv \u001b[38;5;241m*\u001b[39m \u001b[38;5;28;43mabs\u001b[39;49m\u001b[43m(\u001b[49m\u001b[43mff\u001b[49m\u001b[43m)\u001b[49m\n\u001b[1;32m    537\u001b[0m \u001b[38;5;66;03m# Gauss\u001b[39;00m\n\u001b[1;32m    538\u001b[0m s_g \u001b[38;5;241m=\u001b[39m \u001b[38;5;241m0.0\u001b[39m\n",
      "\u001b[0;31mKeyboardInterrupt\u001b[0m: "
     ]
    },
    {
     "data": {
      "image/png": "iVBORw0KGgoAAAANSUhEUgAAAosAAAHrCAYAAACn9tfQAAAAOnRFWHRTb2Z0d2FyZQBNYXRwbG90bGliIHZlcnNpb24zLjEwLjEsIGh0dHBzOi8vbWF0cGxvdGxpYi5vcmcvc2/+5QAAAAlwSFlzAAAPYQAAD2EBqD+naQAATGdJREFUeJzt3XtY1WW+//8XB1noKHggAQklbTxkKoZJaG4rKZrclDPfmSgbIaYyyxyTmVLyQGWK08HNbDUZLTvsqdQONk0ytJWk0jB2KL9se0rRNHegZIKhgcL9+8PLVcu1PspCFovD83Fd67ri9r4/632DvX3x+XzWWj7GGCMAAADABV9vFwAAAIDmi7AIAAAAS4RFAAAAWCIsAgAAwBJhEQAAAJYIiwAAALBEWAQAAIAlwiIAAAAsERYBAABgibAIeNnjjz8uHx8fh8fLL7/s7bLwM3fffbfTzyg/P99p3rlzoqKimrxWAGhshEU0O67C09nHCy+8cMH1I0eOtFwPwHu2bdumzp072/9/7Ny5s7Zt29agY/3www9atmyZbr31VvXq1UsdO3ZUQECAQkNDNWDAAF177bW6//77lZ2drcLCQtXU1Lg8TlRUlGW/OPvo2LGjevXqpcTERC1atEjff/+903GOHDmiSy65xGntc889d959/P3vf3da06FDB3311VcN+r4AHmGAZiYjI8NIcvm46qqrzru2uLjYcm1z/evuar8vvfQSNTUjKSkpTt+PDRs2OM07d06vXr2avNbm6sCBAyYiIsLpexQREWG+/vprt46Vl5dnevTocd7/1899/POf/3R5rF69erl1HEmmc+fO5u9//7vTsd544w2nue3btzdfffWVy+cuKysz3bp1c1rzzDPPuPX9ADzN/+LjJtB0tmzZosLCQg0fPtzlnz///PNNXBHagptuukmdO3d2GLv00ku9U0wL9P333+vmm2/WoUOHnP7s0KFDuvnmm7Vp0yZ16dLlgscqLCzU2LFj9eOPP3qi1Ho5duyYfv/73+v06dNKSUmxj99xxx1auXKl/vGPf9jHTp48qXvvvVcbNmxwurrx0EMP6bvvvnMYGz58uKZNm+bZDQBuIiyixVm6dKnLsFhZWanXXnvNCxWhtRs/frzGjx/v7TJapB9//FG33nqrtm/fbh87GwrPXs7dsWOHEhMTtX79egUGBp73eFOmTHEKiu3bt9d1112niIgI+fn56ciRI9q2bZv27NkjY4zbNd9444264oorJElVVVXasmWLtmzZ4jRv6tSpGjt2rEJCQuxjS5cu1ccff+xwqfqjjz5Sdna2HnjgAfvYmjVr9OabbzocLyAgQCtWrJCfn5/bNQOexD2LaHFWrVrl8p6hV199VVVVVV6oCIArdXV1uuuuu7Rx40b72NChQ1VUVKSioiINHTrUPr5p0ybdeeedqqurszzevn37VFhY6DA2ZMgQffPNN8rJydHy5cuVnZ2tt99+W7t379ahQ4e0bNkyDR8+3K17lsePH6+srCxlZWVp+fLlKioq0tNPP+00r6KiwinwhYeHa+HChU5zp0+froMHD0o6E5IffPBBpzmzZs3SwIED610n0GS8fR0cOJer++UCAgIcvl64cKHTuiuuuOK8a6z+un/xxRcmOzvb3HPPPSY2Ntb06dPHdOnSxfj7+5ugoCDTp08f8+tf/9osW7bMHD9+3LLuDRs2OD1fSkqKMcaYzz77zNx1110mMjLStGvXzqGW+t4fmJ6e7jTvkksuMdu2bXOau3nzZvPQQw+Z6OhoExISYtq1a2dCQkJMbGysmT17tjl06JDLPbh7/1ZD72N8//33zYQJE8zAgQNNUFCQ8ff3N8HBwaZPnz5mxIgRZuLEiebFF180+/fvd1prdf9gdXW1efbZZ010dLT5xS9+Ybp3725uueUWp3sLd+7cae655x7Ts2dPExAQYC699FKTkpJidu/ebVmvp+5ZPHLkiFmwYIG58cYbTUREhAkMDDQdO3Y0v/zlL01qaqr58MMPL/i9LC0tNXPnzjWjR4824eHhJjAw0AQEBJjw8HAzaNAgc9ttt5mMjAyzfv16U11d7bT+fH9vL9bkyZMdjnv33XebkydP2v/85MmT5u6773aYM2nSJMvj/eMf/3Cq1VUvcOX06dMux139nXf197qurs707dvXae7vf/97l8e9+eabneb+6le/Msa4/vs0ZMgQU1NTU6+9AE2NsIhmx1V4uuOOO4yPj4/96759+5q6ujr7mnP/wRsxYoTLfwRciYmJqXc4ioiIMB999JHL41j9o/vss88aPz8/y1rqExbnz5/vNKd79+7myy+/dJh35MgR8+///u8X3Ef79u3NokWLnPbg6bB48uRJM3bs2Hoff8yYMU7HcPUP7Ztvvmmio6NdHsPHx8e+17ffftt06NDB5byOHTuaTz/91GXdngiL//Ef/2Hat29/we/Bv//7v5vvv//e5TFycnJMx44d6/39/OSTT5yO4amw+PO/szabzWRnZ1vO/dvf/mZsNpt9/ty5c13Oe+211xq91vqGRWOM+X//7/85zU1ISHA598CBA6ZTp05O8//whz84jfn7+5stW7Zc1D4AT+IyNFqEfv366YYbbrB/vXv3bn344Yf2r5cuXeow39UlnsZw6NAhJSYmau/evfWav379ev35z39WbW1tg59z8eLFeuyxxxzGQkNDlZ+f73DJ6rvvvlNcXJzef//9Cx7z5MmTmjJliubOndvguhoiMzNTa9eubfTjTpo0ScXFxS7/zBijadOm6cUXX9T48eN14sQJl/N++OEH3XXXXTp16lSj13euhx9+WNOmTdPJkycvOPf999/X6NGjnW6xOHr0qMaPH68ffvjBU2U22Kuvvmr/OxsZGalPPvlE999/v+X8iRMnauPGjerVq5ckafbs2XrppZec5l1yySVOY6+88orGjBmj5cuXa/fu3Q26R7G+XN3+YnWPZWRkpMtL1ytWrHAae+SRRxwuyQPNDS9wQYvxwAMPKC8vz/710qVLNWbMGJWWlmrNmjX28ZCQEP32t7/VzJkz3Tp+v3791KtXL3Xr1k1du3bV6dOn9c033+iTTz5RZWWlfV5lZaXmzZvnsumf6+yrPwMDA3XjjTcqIiJChw4dcgi65/Pyyy/rj3/8o8NYWFiYNmzYoP79+zuM33333dqzZ4/DWPv27XXTTTcpLCxMe/bs0Ycffujwj2lGRoauu+46jRo1SpL0hz/8QUePHtXmzZv12WefORzr5zf9n3Xu1xdy7guQ/Pz8dN111+nyyy+XdOa96rZv365du3a59Y/+d999p4CAACUmJqp9+/Z67733HH5mp0+f1r333ivpTOBITExUaWmpcnJyHI6zb98+vf/++/r1r3/t1r7c8fbbb+uvf/2r0/jw4cM1ePBgHT9+XOvWrdPRo0ftf/bFF1/o4Ycf1vLly+1jOTk5OnbsmMMxIiIidN1116lz58764YcfVFJSoi+++EIVFRUe248rycnJSk5OdmvNsGHDtH///vPOueaaa9S+fXunkP3hhx/a/58KDg7WsGHDNHr0aN12220aPHiwW3VYOXTokNP/E5LUu3dvyzX333+/Vq9erQ0bNljOGTBggDIyMhqlRsBjvHtiE3Dm6rJsRkaGOXXqlMN7q/n7+5tDhw6ZJ5980mHuo48+aoxxfXnJlQ8++MB88803lvUcPnzY9OnTx+E4Xbp0cbgMbozry3mSTJ8+fUxJSYnD3J/f+2h1GXr16tVOl6/Dw8PNzp07nWrcvHmz0zEGDhxoSktLnfbq7+/vMO/666+v18+gMd5n8ez9mmcfixcvdjnvyJEj5u9//7t56qmnnP7M1SVhPz8/h8vC//rXv1z+LCIjIx2+J1OmTHGaM3Xq1Ho9Z0MvQw8YMMDpEuSaNWsc5hw9etQMHjzYaY979+61z5k3b57Dn/fs2dNUVVU5PV9tba35n//5HzNjxgyX97d68p5FT3B17+75Htdcc43l7QXGXPgy9A8//GDy8/Mtb3NYt27deevdu3ev5a0Pvr6+560NaC44s4gWw9/fX/fee6+efPJJSWfOFmVnZztcrvLx8Tnv5S5XbrrpJklnLutt2rRJX331lY4ePaoTJ07YX5nZrl07hzXff/+99u/fr8suu+yCx1+xYoXTvI4dO553TW5urt555x2Hy9c9evTQhg0b1LdvX6f5b7/9ttPYM888o9DQUIexm266Sddff73WrVtnH8vPz9d3332nbt26XXAvF6tTp04OZ8y+/fZb1dXVydfX8Y6YkJAQ3XXXXfU+7q9//Wtdd9119q/HjBkjPz8/p8v/6enpDt+T3/72t1q0aJHDnH379tX7ed21fft27dixw2HsN7/5jcaNG+cw1qVLF02fPt3he1BbW6t3331XaWlpks58L3/uxx9/1HfffacOHTo4jPv6+mrYsGEaNmyYy5quu+46j166bWxPPvmkDh48qL///e/1mr9582b927/9m15//XX97ne/q9ea1NRUpaamXnDeyJEjFR8ff945vXv3VnR0tD799FOnP+vZs6flzwVoTgiLaFEmTpyoefPm2UPAggULHO4xS0hIOO9lIVdKSkr0yCOP6B//+Idb9xaWl5dfMCxedtll+rd/+ze36pHOvD3Qz0VERCg/P99+ufZcri6P3XLLLfV6LmOMNm/erLFjx7pdp7vGjBnj8FYj8+bN09/+9jddeeWV6tu3r/r376/o6GjFxsY6hZ7zORv4z2rXrp26deumw4cPO4yf+w97WFiY07GOHz9e7+d1l6uf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",
      "text/plain": [
       "<Figure size 640x480 with 4 Axes>"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "fig, axs = plt.subplots(2, 2, layout=\"constrained\")\n",
    "fig.suptitle(f'Market smiles: {symbol}', **fontdict_title)\n",
    "\n",
    "############################################################\n",
    "##### Absolute\n",
    "############################################################\n",
    "for maturity, ax in zip(considered_maturities, axs.flatten()):\n",
    "\n",
    "    print(\"=\"*80)\n",
    "    print(maturity)\n",
    "    print(\"=\"*80,\"\\n\")\n",
    "\n",
    "    ####################################\n",
    "    ### Getting and filtering data \n",
    "    ####################################\n",
    "\n",
    "    full_market_data = filter_data_for_maturity(all_market_data, maturity)\n",
    "    time_to_maturity = full_market_data['Time to Maturity'].iloc[0]\n",
    "    strikes = full_market_data['Strike'].values\n",
    "    bid_prices = full_market_data[\"Bid\"].values\n",
    "    ask_prices = full_market_data['Ask'].values\n",
    "    market_ivs = full_market_data['Implied Volatility'].values\n",
    "    market_prices = full_market_data['Call Price'].values\n",
    "\n",
    "    marketVolatilitySmile = VolatilitySmile(\n",
    "        strikes=strikes,\n",
    "        time_to_maturity=time_to_maturity,\n",
    "        atm=spot,\n",
    "        market_ivs=market_ivs,\n",
    "        r=r\n",
    "    )\n",
    "    market_data = marketVolatilitySmile.filters(full_market_data, select_mid_ivs=True)\n",
    "\n",
    "    ####################################\n",
    "    ### Calibration \n",
    "    ####################################\n",
    "    heston = Heston(spot=spot, r=r, **params)\n",
    "    initial_params = marketVolatilitySmile.calibration(\n",
    "        price_function=heston.call_price,\n",
    "        guess_correlation_sign='negative',\n",
    "        initial_guess=[params['kappa'], params['theta'], params['sigma'], params['rho']],\n",
    "        speed='local',\n",
    "    )\n",
    "\n",
    "    # Absolute calibration\n",
    "    calibrated_params = marketVolatilitySmile.calibration(\n",
    "        relative_errors=False,\n",
    "        price_function=heston.call_price,\n",
    "        guess_correlation_sign='negative',\n",
    "        initial_guess=[initial_params['kappa'], initial_params['theta'], initial_params['sigma'], initial_params['rho']],\n",
    "        speed='global',\n",
    "        power='mse'\n",
    "    )\n",
    "    calibrated_prices = heston.call_price(\n",
    "        strike=marketVolatilitySmile.strikes, time_to_maturity=time_to_maturity, **calibrated_params\n",
    "    )\n",
    "    print(marketVolatilitySmile.evaluate_calibration(calibrated_prices, 'price'))\n",
    "    calibrated_ivs = marketVolatilitySmile.compute_smile(prices=calibrated_prices)\n",
    "    print(marketVolatilitySmile.evaluate_calibration(calibrated_ivs, 'iv'))\n",
    "\n",
    "    # Relative calibration\n",
    "    calibrated_params_relative = marketVolatilitySmile.calibration(\n",
    "        relative_errors=True,\n",
    "        price_function=heston.call_price,\n",
    "        guess_correlation_sign='negative',\n",
    "        initial_guess=[initial_params['kappa'], initial_params['theta'], initial_params['sigma'], initial_params['rho']],\n",
    "        speed='global',\n",
    "        power='mse'\n",
    "    )\n",
    "    calibrated_prices_relative = heston.call_price(\n",
    "        strike=marketVolatilitySmile.strikes, time_to_maturity=time_to_maturity, **calibrated_params_relative\n",
    "    )\n",
    "    print(marketVolatilitySmile.evaluate_calibration(calibrated_prices_relative, 'price'))\n",
    "    calibrated_ivs_relative = marketVolatilitySmile.compute_smile(prices=calibrated_prices_relative)\n",
    "    print(marketVolatilitySmile.evaluate_calibration(calibrated_ivs_relative, 'iv'))\n",
    "\n",
    "    # Some plots\n",
    "    ask_ivs = market_data['Ask ivs'].values\n",
    "    bid_ivs = market_data['Bid ivs'].values\n",
    "    forward = marketVolatilitySmile.atm * np.exp(marketVolatilitySmile.r * marketVolatilitySmile.time_to_maturity)\n",
    "\n",
    "    if ax == axs.flatten()[-2]:\n",
    "        ax.axvline(1, linestyle=\"--\", color=\"gray\", label=\"ATM\")\n",
    "        ax.plot(marketVolatilitySmile.strikes / forward, calibrated_ivs, label=\"absolute calibration\", marker='+', color='blue', linestyle=\"dotted\", markersize=4)\n",
    "        ax.plot(marketVolatilitySmile.strikes / forward, calibrated_ivs_relative, label=\"relative calibration\", marker='+', color='green', linestyle=\"dotted\", markersize=4)\n",
    "        ax.scatter(marketVolatilitySmile.strikes / forward, marketVolatilitySmile.market_ivs, label=\"mid\", marker='o', color='red', s=20)\n",
    "        ax.scatter(marketVolatilitySmile.strikes / forward, bid_ivs, label=\"bid\", marker=6, color='black', s=20)\n",
    "        ax.scatter(marketVolatilitySmile.strikes / forward, ask_ivs, label=\"ask\", marker=7, color='gray', s=20)\n",
    "        ax.legend(loc='upper right', prop=font_legend, ncol=2, alignment='left')\n",
    "    else:\n",
    "        ax.axvline(1, linestyle=\"--\", color=\"gray\")\n",
    "        ax.plot(marketVolatilitySmile.strikes / forward, calibrated_ivs, marker='+', color='blue', linestyle=\"dotted\", markersize=4)\n",
    "        ax.plot(marketVolatilitySmile.strikes / forward, calibrated_ivs_relative, marker='+', color='green', linestyle=\"dotted\", markersize=4)\n",
    "        ax.scatter(marketVolatilitySmile.strikes / forward, marketVolatilitySmile.market_ivs, marker='o', color='red', s=20)\n",
    "        ax.scatter(marketVolatilitySmile.strikes / forward, bid_ivs, marker=6, color='black', s=20)\n",
    "        ax.scatter(marketVolatilitySmile.strikes / forward, ask_ivs, marker=7, color='gray', s=20)\n",
    "\n",
    "    ax.set_xlabel(\"Moneyness [%]\", fontdict=fontdict)\n",
    "    ax.set_ylabel(\"Implied Volatility [%]\", fontdict=fontdict)\n",
    "\n",
    "    date = datetime.strptime(maturity, '%Y-%m-%d').date().strftime(\"%d-%B-%y\")\n",
    "    title = f\"{date}: {marketVolatilitySmile.time_to_maturity * 252 / 5:.1f} semaines\"\n",
    "    ax.set_title(title, fontdict=fontdict)\n",
    "    ax.grid(visible=True, which=\"major\", linestyle=\"--\", dashes=(5, 10), color=\"gray\", linewidth=0.5, alpha=0.8)\n",
    "\n",
    "plt.show()"
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": ".venv",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.10.16"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
